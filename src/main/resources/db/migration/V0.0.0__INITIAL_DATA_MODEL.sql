CREATE TABLE USERS
(
    ID            INTEGER GENERATED BY DEFAULT AS IDENTITY,
    USERNAME      VARCHAR(50)  NOT NULL,
    ROLE          VARCHAR(50)  NOT NULL,
    PASSWORD_HASH VARCHAR(100) NOT NULL,
    PASSWORD_SALT VARCHAR(100) NOT NULL,
    CREATED       TIMESTAMP(6) NOT NULL,
    MODIFIED      TIMESTAMP(6),
    CONSTRAINT USERS_PK PRIMARY KEY (ID),
    CONSTRAINT USERS_USERNAME_UC UNIQUE (USERNAME)
);

CREATE TABLE ORGANIZATIONS
(
    ID          INTEGER GENERATED BY DEFAULT AS IDENTITY,
    NAME        VARCHAR(50)  NOT NULL,
    DESCRIPTION VARCHAR(4000),
    CREATED     TIMESTAMP(6) NOT NULL,
    MODIFIED    TIMESTAMP(6),
    CONSTRAINT ORGANIZATIONS_PK PRIMARY KEY (ID),
    CONSTRAINT ORGANIZATIONS_NAME_UC UNIQUE (NAME)
);

CREATE TABLE MEMBERS
(
    ID              INTEGER GENERATED BY DEFAULT AS IDENTITY,
    ORGANIZATION_ID INTEGER     NOT NULL,
    USER_ID         INTEGER     NOT NULL,
    ROLE            VARCHAR(50) NOT NULL,
    CONSTRAINT ORGANIZATION_ID_USER_ID_UC UNIQUE (ORGANIZATION_ID, USER_ID),
    CONSTRAINT MEMBERS_PK PRIMARY KEY (ID)
);

CREATE TABLE BOXES
(
    ID              INTEGER GENERATED BY DEFAULT AS IDENTITY,
    NAME            VARCHAR(50)  NOT NULL,
    DESCRIPTION     VARCHAR(4000),
    ORGANIZATION_ID INTEGER      NOT NULL,
    CREATED         TIMESTAMP(6) NOT NULL,
    MODIFIED        TIMESTAMP(6),
    CONSTRAINT BOXES_PK PRIMARY KEY (ID),
    CONSTRAINT BOXES_NAME_GROUP_ID_UC UNIQUE (NAME, ORGANIZATION_ID),
    CONSTRAINT ORGANIZATION_ID_FK FOREIGN KEY (ORGANIZATION_ID) REFERENCES ORGANIZATIONS (ID)
);

CREATE TABLE VERSIONS
(
    ID          INTEGER GENERATED BY DEFAULT AS IDENTITY,
    NAME        VARCHAR(50)  NOT NULL,
    DESCRIPTION VARCHAR(4000),
    BOX_ID      INTEGER      NOT NULL,
    CREATED     TIMESTAMP(6) NOT NULL,
    MODIFIED    TIMESTAMP(6),
    CONSTRAINT VERSIONS_PK PRIMARY KEY (ID),
    CONSTRAINT VERSIONS_NAME_BOX_ID_UC UNIQUE (NAME, BOX_ID),
    CONSTRAINT BOX_ID_FK FOREIGN KEY (BOX_ID) REFERENCES BOXES (ID)
);

CREATE TABLE PROVIDERS
(
    ID         INTEGER GENERATED BY DEFAULT AS IDENTITY,
    TYPE       VARCHAR(50)  NOT NULL,
    SIZE       BIGINT,
    ALGORITHM  VARCHAR(10),
    CHECKSUM   VARCHAR(100),
    VERSION_ID INTEGER      NOT NULL,
    CREATED    TIMESTAMP(6) NOT NULL,
    MODIFIED   TIMESTAMP(6),
    CONSTRAINT PROVIDERS_PK PRIMARY KEY (ID),
    CONSTRAINT PROVIDERS_NAME_VERSION_ID_UC UNIQUE (TYPE, VERSION_ID),
    CONSTRAINT VERSION_ID_FK FOREIGN KEY (VERSION_ID) REFERENCES VERSIONS (ID)
);
